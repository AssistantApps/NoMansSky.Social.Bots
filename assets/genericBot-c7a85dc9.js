import{c as G,a as v,N as l,b as e,B as f,G as S,M as R,d as F,e as H,f as q,g as z,S as p,C as b,L as T,V as Q,F as B,H as $,A as D,h as M,i as V,j as J,t as _,k as x,l as A,m as P,I as Ne,n as I,o as De,p as Le,T as Pe,D as Ie,q as je,r as Ee,s as Ge,u as Oe,v as Ae,w as Re,x as Fe,y as O,z as W,E as He,J as qe,K as ze,O as Qe,P as Ve,U as Je,Q as We,R as Te,W as Ke,X as j,Y as Ue,Z as Xe,_ as Ye,$ as Ze,a0 as et,a1 as tt,a2 as nt,a3 as rt,a4 as st,a5 as at,a6 as ot,a7 as lt,a8 as ct,a9 as it,aa as ut,ab as dt,ac as gt,ad as ht}from"./index-b7f40ea9.js";import{R as mt}from"./responsiveCustomGrid-1b9bc2a1.js";import{g as K}from"./mastodonHelper-8eedca94.js";const pt=_("<span>Last status is null 🤷</span>"),St=_("<div></div>"),wt=n=>{const{isOpen:d,onOpen:i,onClose:r}=G(),[a,o]=v(l.Loading),[g,m]=v([]),h=async t=>{o(l.Loading),i();const[s,c]=await K(t);if(c==null)return;const u=await s.getConversations(c);if(u.isSuccess==!1){x().e(t.name,"Could not fetch conversations",u.errorMessage),o(l.Error);return}m(u.value),o(l.Success)};return[e(S,{get["data-key"](){return n.botMeta.type},pt:"1.5em",colSpan:2,get children(){return e(f,{colorScheme:"accent",width:"100%",onClick:()=>h(n.botMeta),children:"🐘 Display latest conversations!"})}}),e(J,{size:"4xl",get opened(){return d()},onClose:r,get children(){return[e(R,{}),e(F,{get children(){return[e(H,{}),e(q,{children:"Conversations"}),e(z,{get children(){return[e(p,{get when(){return a()==l.Error},get children(){return e(b,{children:"Something went wrong"})}}),e(p,{get when(){return a()==l.Loading},get children(){return e(b,{minH:"50vh",width:"100%",get children(){return e(T,{})}})}}),e(p,{get when(){return a()==l.Success},get children(){return e(p,{get when(){return g().length>0},get fallback(){return e(b,{children:"No Items"})},get children(){return e(Q,{class:"conversations",justifyContent:"flex-start",alignItems:"flex-start",get children(){return e(B,{get each(){return g()},children:t=>{var c,u,y,C;t.last_status==null&&e($,{class:"convo",get children(){return[e(D,{src:"/assets/img/quicksilverCompanion.png"}),e(M,{class:"content limit-height",ml:10,flexGrow:4,get children(){return pt.cloneNode(!0)}})]}});let s=(u=(c=t.last_status)==null?void 0:c.content)!=null?u:"";for(const w of(C=(y=t.last_status)==null?void 0:y.emojis)!=null?C:[])s=s.replaceAll(`:${w.shortcode}:`,`<img src="${w.static_url}" class="emoji" alt="${w.shortcode}" />`);return e($,{class:"convo",get children(){return[e(D,{get src(){var w,N;return(N=(w=t.last_status)==null?void 0:w.account)==null?void 0:N.avatar}}),e(M,{class:"content limit-height",ml:10,flexGrow:4,get children(){const w=St.cloneNode(!0);return w.innerHTML=s,w}})]}})}})}})}})}})]}}),e(V,{get children(){return e(f,{onClick:r,children:"Close"})}})]}})]}})]},vt=n=>[e(S,{pt:"1.5em",colSpan:2,get children(){return e(A,{get children(){return[e(P,{for:"email",children:"Email"}),e(Ne,{get children(){return[e(I,{id:"email",type:"text",disabled:!0,get value(){return n.botMeta.email}}),e(De,{cursor:"pointer",onClick:()=>Le(n.botMeta.email),children:"📋"})]}})]}})}}),e(S,{pt:"1.5em",colSpan:2,get children(){return e(A,{get children(){return[e(P,{for:"password",children:"Password"}),e(Ne,{get children(){return[e(I,{id:"password",type:"password",disabled:!0,get value(){return n.botMeta.password}}),e(De,{cursor:"pointer",onClick:()=>Le(n.botMeta.password),children:"📋"})]}})]}})}})],Ct=_("<span>Last status is null 🤷</span>"),bt=_("<div></div>"),ft=n=>{const{isOpen:d,onOpen:i,onClose:r}=G(),[a,o]=v(l.Loading),[g,m]=v([]),h=async t=>{o(l.Loading),i();const[s,c]=await K(t);if(c==null)return;const u=await s.getNotifications(c);if(u.isSuccess==!1){x().e(t.name,"Could not fetch notifications",u.errorMessage),o(l.Error);return}m(u.value),o(l.Success)};return[e(S,{get["data-key"](){return n.botMeta.type},pt:"1.5em",colSpan:2,get children(){return e(f,{colorScheme:"accent",width:"100%",onClick:()=>h(n.botMeta),children:"🐘 Display latest notifications!"})}}),e(J,{size:"4xl",get opened(){return d()},onClose:r,get children(){return[e(R,{}),e(F,{get children(){return[e(H,{}),e(q,{children:"Notifications"}),e(z,{get children(){return[e(p,{get when(){return a()==l.Error},get children(){return e(b,{children:"Something went wrong"})}}),e(p,{get when(){return a()==l.Loading},get children(){return e(b,{minH:"50vh",width:"100%",get children(){return e(T,{})}})}}),e(p,{get when(){return a()==l.Success},get children(){return e(p,{get when(){return g().length>0},get fallback(){return e(b,{children:"No Items"})},get children(){return e(Q,{class:"conversations",justifyContent:"flex-start",alignItems:"flex-start",get children(){return e(B,{get each(){return g()},children:t=>{var y,C,w,N,U,X,Y,Z,ee,te,ne,re,se,ae,oe,le,ce,ie,ue,de,ge,he,me,pe,Se,we,ve,Ce,be,fe,ye,Me,_e,ke,$e,xe;t.status==null&&e($,{class:"convo",get children(){return[e(D,{src:"/assets/img/quicksilverCompanion.png"}),e(M,{class:"content limit-height",ml:10,flexGrow:4,get children(){return Ct.cloneNode(!0)}})]}});let s="unknown",c="/assets/img/quicksilverCompanion.png",u="Nothing to see here...";t.type=="mention"&&(s=(w=(C=(y=t.status)==null?void 0:y.account)==null?void 0:C.display_name)!=null?w:s,c=(X=(U=(N=t.status)==null?void 0:N.account)==null?void 0:U.avatar)!=null?X:c,u=`Mention 💬<br/>${(Y=t.status)==null?void 0:Y.content}`),t.type=="status"&&(s=(te=(ee=(Z=t.status)==null?void 0:Z.account)==null?void 0:ee.display_name)!=null?te:s,c=(se=(re=(ne=t.status)==null?void 0:ne.account)==null?void 0:re.avatar)!=null?se:c,u=(oe=(ae=t.status)==null?void 0:ae.content)!=null?oe:u),t.type=="reblog"&&(s=t.account.display_name,c=t.account.avatar,u=`Boosted 🚀 <br/>${(ce=(le=t.status)==null?void 0:le.content)!=null?ce:"a toot"}`),t.type=="follow"&&(s=t.account.display_name,c=t.account.avatar,u=`New Follow! 🫂 <br/> ${t.account.display_name}`),t.type=="follow_request"&&(s=(de=(ue=(ie=t.status)==null?void 0:ie.account)==null?void 0:ue.display_name)!=null?de:s,c=(me=(he=(ge=t.status)==null?void 0:ge.account)==null?void 0:he.avatar)!=null?me:c,u="Wants to Follow!"),t.type=="favourite"&&(s=t.account.display_name,c=t.account.avatar,u=`Favourited ⭐ <br/>${(Se=(pe=t.status)==null?void 0:pe.content)!=null?Se:"a toot"}`),t.type=="poll"&&(s=t.account.display_name,c=t.account.avatar,u=`Poll 📊 <br/>${(ve=(we=t.status)==null?void 0:we.content)!=null?ve:"a toot"}`),t.type=="update"&&(s=(fe=(be=(Ce=t.status)==null?void 0:Ce.account)==null?void 0:be.display_name)!=null?fe:s,c=(_e=(Me=(ye=t.status)==null?void 0:ye.account)==null?void 0:Me.avatar)!=null?_e:c,u=`Mention 💬<br/>${(ke=t.status)==null?void 0:ke.content}`),t.type=="admin.sign_up"&&(s=t.account.display_name,c=t.account.avatar,u=`New user sign up! ✨ <br />${s}`),t.type=="admin.report"&&(s=t.account.display_name,c=t.account.avatar,u=`Admin report? 🔥⛔ <br />${s}`);for(const k of(xe=($e=t.status)==null?void 0:$e.emojis)!=null?xe:[])u=u.replaceAll(`:${k.shortcode}:`,`<img src="${k.static_url}" class="emoji" alt="${k.shortcode}" />`);return e($,{class:"notification",get children(){return[e(Pe,{label:s,get children(){return e(D,{src:c,backgroundColor:"transparent"})}}),e(M,{class:"content limit-height",ml:10,flexGrow:4,get children(){const k=bt.cloneNode(!0);return k.innerHTML=u,k}})]}})}})}})}})}})]}}),e(V,{get children(){return e(f,{onClick:r,children:"Close"})}})]}})]}})]},L=()=>e(S,{pt:"1.5em",colSpan:{"@initial":"4","@xl":"4"},display:{"@initial":"unset"},get children(){return e(Ie,{})}});var yt=Object.defineProperty,Mt=Object.getOwnPropertyDescriptor,_t=(n,d,i,r)=>{for(var a=r>1?void 0:r?Mt(d,i):d,o=n.length-1,g;o>=0;o--)(g=n[o])&&(a=(r?g(d,i,a):g(a))||a);return r&&a&&yt(d,i,a),a};let E=class extends Ee{constructor(){super("https://api.nomanssky.social")}triggerQuicksilverMerchant(n){return this.post("qs",{},()=>({headers:{Authorization:n}}))}};E=_t([je()],E);const kt=()=>Ge.get(E),$t=()=>{const n=Oe(Ae),[d,i]=v(l.Pending),r=async()=>{var m;const a=kt(),o=(m=n==null?void 0:n.apiAuthToken)!=null?m:"",g=await a.triggerQuicksilverMerchant(o);if(g.isSuccess==!1){const h="Could not trigger QS merchant message post";x().e(h,g.errorMessage),Re({title:h})}i(l.Success)};return[e(S,{pt:"1.5em",colSpan:2,get children(){return e(f,{colorScheme:"accent",width:"100%",get loading(){return d()==l.Loading},onClick:r,children:"📈 Post QS status image"})}}),e(S,{pt:"1.5em",colSpan:2,get children(){return e(f,{colorScheme:"accent",width:"100%",disabled:!0,onClick:r,children:"❓ Coming soon?"})}})]},xt={dialogJson:"https://github.com/AssistantApps/NoMansSky.Social.Bots/blob/main/src/assets/data/dialogs.json"},Nt=_('<a target="_blank" rel="noopener noreferrer"></a>'),Be="nmscdCommunitySearch",Dt=n=>{const d=r=>r.includes("@")?r:r.includes("?")?r+`&ref=${Be}`:r+`?ref=${Be}`,i=r=>{n.onClick!=null&&(r.preventDefault(),n.onClick())};return(()=>{const r=Nt.cloneNode(!0);return r.$$click=i,O(r,"draggable",!1),W(r,()=>n.children),He(a=>{var h;const o=n.id,g=d(n.href),m=(h=n.additionalClassNames)!=null?h:"";return o!==a._v$&&O(r,"id",a._v$=o),g!==a._v$2&&O(r,"href",a._v$2=g),m!==a._v$3&&qe(r,a._v$3=m),a},{_v$:void 0,_v$2:void 0,_v$3:void 0}),r})()};Fe(["click"]);const Lt=n=>{const[d,i]=v(l.Loading),[r,a]=v([]);ze(()=>{o(n.botMeta.dialog)});const o=async g=>{const h=await Qe().getDialogFile();h.isSuccess==!1&&(x().e(n.botMeta.name,"Could not fetch github file",h.errorMessage),i(l.Error));const t=h.value[g];t!=null&&t.length>0&&(a(t),i(l.Success))};return[e(p,{get when(){return d()==l.Error},get children(){return e(b,{children:"Something went wrong"})}}),e(p,{get when(){return d()==l.Loading},get children(){return e(S,{colSpan:4,get children(){return e(b,{get children(){return e(T,{})}})}})}}),e(p,{get when(){return d()==l.Success},get children(){return e(S,{colSpan:4,get children(){return[e(Ve,{children:"Current possible dialog options:"}),e(Je,{get children(){return e(B,{get each(){return r()},children:g=>e(We,{get children(){return g.message}})})}}),e(b,{mt:"1em",get children(){return e(Dt,{get href(){return xt.dialogJson},children:"Edit the dialog options in the JSON file ↗"})}})]}})}})]},Tt=n=>e(Ue,{get fallback(){return[]},get children(){return[e(Te,{get when(){return Ke().includes(n.botMeta.type)},get children(){return[e(Lt,{get botMeta(){return n.botMeta}}),e(L,{})]}}),e(Te,{get when(){return n.botMeta.type===j.qsCompanion},get children(){return[e($t,{}),e(L,{})]}})]}}),Bt=n=>new Promise(d=>setTimeout(d,n)),Ot=_('<div id="bot-timeline" class="mt-body" style="width: 100%"></div>'),At=n=>{const{isOpen:d,onOpen:i,onClose:r}=G(),a=async o=>{i(),await Bt(100);try{window.loadMasto({container_body_id:"bot-timeline",instance_uri:"https://nomanssky.social",user_id:o.userId,profile_name:o.profileName,toots_limit:5})}catch{}};return[e(S,{get["data-key"](){return n.botMeta.type},pt:"1.5em",colSpan:2,get children(){return e(f,{colorScheme:"accent",width:"100%",onClick:()=>a(n.botMeta),children:"🐘 Display latest Toots!"})}}),e(J,{size:"xl",get opened(){return d()},onClose:r,get children(){return[e(R,{}),e(F,{get children(){return[e(H,{}),e(q,{children:"Latest Toots!"}),e(z,{get children(){const o=Ot.cloneNode(!0);return W(o,e(b,{minH:"50vh",width:"100%",get children(){return e(T,{})}})),o}}),e(V,{get children(){return e(f,{onClick:r,children:"Close"})}})]}})]}})]},Pt=_("<i></i>"),It=n=>{const d=["public","private","unlisted"],[i,r]=v(l.Pending),[a,o]=v(""),[g,m]=v(d[0]),h=async()=>{r(l.Loading);const[t,s]=await K(n.botMeta);if(s==null)return;const c={status:a(),visibility:g()};await t.sendToot(s,c),r(l.Success)};return e(S,{colSpan:{"@initial":"4","@xl":"2"},get children(){return e(Q,{as:"form",spacing:"$5",alignItems:"stretch",get children(){return[e($,{get children(){return[e(Xe,{get src(){return n.botMeta.imageUrl},get alt(){return n.botMeta.profileName},borderRadius:"10px",mt:"1em",maxH:"50px"}),e(M,{m:"10px"}),e(A,{get children(){return[e(P,{for:"message",get children(){return["Message to send as ",(()=>{const t=Pt.cloneNode(!0);return W(t,()=>n.botMeta.profileName),t})()]}}),e(I,{id:"message",type:"text",onInput:t=>{var s,c;o((c=(s=t==null?void 0:t.target)==null?void 0:s.value)!=null?c:"")}})]}})]}}),e($,{justifyContent:"flex-end",get children(){return[e(Ye,{flexGrow:4}),e(M,{flexGrow:1,get children(){return e(Ze,{get value(){return g()},onChange:m,get children(){return[e(et,{get children(){return[e(tt,{}),e(nt,{})]}}),e(rt,{get children(){return e(st,{get children(){return e(B,{each:d,children:t=>e(at,{value:t,get children(){return[e(ot,{children:t}),e(lt,{})]}})})}})}})]}})}}),e(M,{m:5}),e(f,{type:"submit",flexGrow:1,get loading(){return i()===l.Loading},onClick:t=>{var s;(s=t==null?void 0:t.preventDefault)==null||s.call(t),h()},children:"Submit"})]}})]}})}})},Rt=()=>{const n=ct(),d=it(),i=Oe(Ae),[r,a]=v(l.Loading),[o,g]=v();ut(()=>{a(l.Loading),m()},[n.id]);const m=()=>{var y;x().i("initializePage");const h=i==null||i.accounts==null||i.accounts.length<1||i.apiAuthToken==null;let t=!1,s=j.unknown;try{const C=n.id;s=C,t=C==null||s==null||s===j.unknown}catch{t=!0}if(h||t){x().e("something went wrong",{invalidCreds:h,invalidBotType:t}),d(dt.home,{replace:!0});return}const c=((y=i==null?void 0:i.accounts)!=null?y:[]).findIndex(C=>C.type===s);if(c<0)return;const u=i.accounts[c];g(u),a(l.Success)};return e(mt,{get children(){return[e(p,{get when(){return r()==l.Error},get children(){return e(b,{children:"Something went wrong"})}}),e(p,{get when(){return r()==l.Loading},get children(){return e(S,{colSpan:4,get children(){return e(gt,{})}})}}),e(p,{get when(){return r()==l.Success},get children(){return[e(S,{colSpan:4,get children(){return e(ht,{get text(){return o().name}})}}),e(Tt,{get botMeta(){return o()}}),e(It,{get botMeta(){return o()}}),e(L,{}),e(At,{get botMeta(){return o()}}),e(wt,{get botMeta(){return o()}}),e(ft,{get botMeta(){return o()}}),e(L,{}),e(vt,{get botMeta(){return o()}}),e(S,{}),e(M,{m:"3em"})]}})]}})};export{Rt as GenericBotPage,Rt as default};
