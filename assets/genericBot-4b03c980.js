import{c as e,G as R,D as F,a as l,H as E,d as G,s as v,i as $,b as H,e as A,t as _,f as p,N as i,o as J,g as j,h as y,C as w,S as h,L as z,U as O,j as q,k as V,l as C,M as N,m as K,B as k,n as Q,V as U,p as B,I as W,q as I,r as X,u as Y,v as Z,w as T,x as ee,y as te,z as ne,A as re,E as ie,J as ae,K as oe}from"./index-3134f122.js";import{P as se}from"./pageHeader-7b8a3a1b.js";const ce=t=>e(R,{gap:"$4",templateColumns:"repeat(4, 1fr)",width:"100%",get children(){return t.children}}),M=()=>e(l,{pt:"1.5em",colSpan:{"@initial":"4","@lg":"2"},display:{"@initial":"unset","@lg":"none"},get children(){return e(F,{})}}),le=()=>e(l,{colSpan:4,get children(){return e(E,{children:"Hi"})}}),ue={dialogJson:"https://github.com/AssistantApps/NoMansSky.Social.Bots/blob/main/src/assets/data/dialogs.json"},de=_('<a target="_blank" rel="noopener noreferrer"></a>'),D="nmscdCommunitySearch",ge=t=>{const o=n=>n.includes("@")?n:n.includes("?")?n+`&ref=${D}`:n+`?ref=${D}`,r=n=>{t.onClick!=null&&(n.preventDefault(),t.onClick())};return(()=>{const n=de.cloneNode(!0);return n.$$click=r,v(n,"draggable",!1),$(n,()=>t.children),H(a=>{var u;const s=t.id,c=o(t.href),m=(u=t.additionalClassNames)!=null?u:"";return s!==a._v$&&v(n,"id",a._v$=s),c!==a._v$2&&v(n,"href",a._v$2=c),m!==a._v$3&&A(n,a._v$3=m),a},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})()};G(["click"]);const he=t=>{const[o,r]=p(i.Loading),[n,a]=p([]);J(()=>{s(t.botMeta.dialog)});const s=async c=>{const u=await j().getDialogFile();u.isSuccess==!1&&(y().e(t.botMeta.name,"Could not fetch github file",u.errorMessage),r(i.Error));const f=u.value[c];f!=null&&f.length>0&&(a(f),r(i.Success))};return[e(h,{get when(){return o()==i.Error},get children(){return e(w,{children:"Something went wrong"})}}),e(h,{get when(){return o()==i.Loading},get children(){return e(l,{colSpan:4,get children(){return e(w,{get children(){return e(z,{})}})}})}}),e(h,{get when(){return o()==i.Success},get children(){return e(l,{colSpan:4,get children(){return[e(E,{children:"Current possible dialog options:"}),e(O,{get children(){return e(q,{get each(){return n()},children:c=>e(V,{get children(){return[C(()=>c.type)," - ",C(()=>c.message)]}})})}}),e(w,{mt:"1em",get children(){return e(ge,{get href(){return ue.dialogJson},children:"Edit the dialog options in the JSON file ↗"})}})]}})}})]},me=t=>e(Q,{get fallback(){return[]},get children(){return[e(N,{get when(){return K().includes(t.botMeta.type)},get children(){return[e(he,{get botMeta(){return t.botMeta}}),e(M,{})]}}),e(N,{get when(){return t.botMeta.type===k.qsCompanion},get children(){return[e(le,{}),e(M,{})]}})]}}),fe=_("<i></i>"),Se=t=>(p(i.Pending),e(l,{colSpan:{"@initial":"4","@lg":"2"},get children(){return e(U,{as:"form",spacing:"$5",alignItems:"stretch",get children(){return[e(B,{get children(){return[e(W,{get src(){return t.botMeta.imageUrl},get alt(){return t.botMeta.profileName},borderRadius:"10px",mt:"1em",maxH:"50px"}),e(I,{m:"10px"}),e(X,{get children(){return[e(Y,{for:"message",get children(){return["Message to send as ",(()=>{const o=fe.cloneNode(!0);return $(o,()=>t.botMeta.profileName),o})()]}}),e(Z,{id:"message",type:"text"})]}})]}}),e(B,{justifyContent:"flex-end",get children(){return e(T,{type:"submit",children:"Submit"})}})]}})}})),pe=_('<div id="bot-timeline" class="mt-body" style="width: 100%"></div>'),ve=()=>{const t=ee(),o=te(),r=ne(re),[n,a]=p(i.Loading),[s,c]=p();ie(()=>{a(i.Loading),m()},[t.id]);const m=()=>{var L;y().i("initializePage");const d=r==null||r.accounts==null||r.accounts.length<1||r.apiAuthToken==null;let g=!1,b=k.unknown;try{const S=t.id;b=S,g=S==null||b==null||b===k.unknown}catch{g=!0}if(d||g){y().e("something went wrong",{invalidCreds:d,invalidBotType:g}),o(ae.home,{replace:!0});return}const x=((L=r==null?void 0:r.accounts)!=null?L:[]).findIndex(S=>S.type===b);if(x<0)return;const P=r.accounts[x];c(P),a(i.Success)},u=d=>{if(d!=null)try{window.loadMasto({container_body_id:"bot-timeline",instance_uri:"https://nomanssky.social",user_id:d.userId,profile_name:d.profileName,toots_limit:5})}catch{}},f=d=>e(l,{"data-key":d,pt:"1.5em",colSpan:{"@initial":"4","@lg":"2"},get children(){const g=pe.cloneNode(!0);return $(g,e(T,{colorScheme:"accent",width:"100%",onClick:()=>u(s()),children:"🐘 Display latest Toots!"})),g}});return e(ce,{get children(){return[e(h,{get when(){return n()==i.Error},get children(){return e(w,{children:"Something went wrong"})}}),e(h,{get when(){return n()==i.Loading},get children(){return e(l,{colSpan:4,get children(){return e(oe,{})}})}}),e(h,{get when(){return n()==i.Success},get children(){return[e(l,{colSpan:4,get children(){return e(se,{get text(){return s().name}})}}),e(me,{get botMeta(){return s()}}),e(Se,{get botMeta(){return s()}}),e(M,{}),C(()=>f(s().type)),e(l,{}),e(I,{m:"3em"})]}})]}})};export{ve as GenericBotPage,ve as default};
